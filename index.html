<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scrap Masters</title>
 
    <link rel="icon" type="image/png" sizes="16x16" href="assets/icon/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/icon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="assets/icon/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="assets/icon/android-chrome-512x512.png">
    <link rel="apple-touch-icon" href="assets/icon/apple-touch-icon.png">
    <link rel="manifest" href="assets/icon/site.webmanifest">

    <link rel="shortcut icon" type="image/png" href="assets/icon/favicon-32x32.png">
    <link rel="stylesheet" href="styles.css?v=1.0.9">
    <link rel="stylesheet" href="themes.css?v=1.0.1">
</head>
<body>

    <div id="settings-container">
        <img id="settings-btn" src="assets/settings.png" alt="Settings" title="Settings">

    <div id="chat-container">
            <img id="earth-btn" src="assets/earth.png" alt="Global Chat" title="Global Chat">
            <img id="leaderboard-btn" src="assets/leaderboard.png" alt="Leaderboard" title="Leaderboard" onclick="window.openLeaderboard && window.openLeaderboard('rebirths')">
            <img id="itemshop-btn" class="hidden" src="assets/itemshop.png" alt="Item Shop" title="Item Shop" onclick="window.openItemShop && window.openItemShop()">
            <img id="inventory-btn" src="assets/inventory1.png" alt="Inventory" title="Inventory">
        </div>
    </div>
    <div class="version-info">Version 1.4 Multiplayer update</div>
    <div class="game-content">
        <!-- Active boosts banner -->
        <div id="boosts-banner" class="hidden"></div>
        <div id="counter">Scrap: 0</div>
    <div id="brick-counter" class="hidden" style="font-size: 24px; margin-bottom: 15px; color: #e67e22;">Brick: 0</div>
    <div id="tiles-counter" class="hidden" style="font-size: 24px; margin-bottom: 15px; color: #9b59b6;">Tires: 0</div>
        <img id="scrap-image" src="assets/scrap.png" alt="Scrap">
        <div id="cooldown-container">
            <div id="cooldown-bar"></div>
            <div id="cooldown-timer">5.00</div>
        </div>
<div id="bottom-buttons">
    <div id="greenupgrade-container">
        <img id="greenupgrade-btn" src="assets/greenupgrade.png" alt="Green Upgrade">
    </div>
    <div id="book-container" class="hidden">
        <img id="book-btn" src="assets/book.png" alt="Book" title="Skills Book">
    </div>
    <div id="mysterybook-container" class="hidden">
        <img id="mysterybook-btn" src="assets/mysterybook.png" alt="Mystery Book" title="Mystery Book">
    </div>
    <div id="tree-container" class="hidden">
        <img id="tree-btn" src="assets/tree.png" alt="Skill Tree" title="Skill Tree">
    </div>
    <div id="blueupgrade-container" class="hidden">
        <img id="blueupgrade-btn" src="assets/blueupgrade.png" alt="Blue Upgrade" title="Blue Upgrades">
    </div>
    <div id="upgrade-container">
        <img id="upgrade-btn" src="assets/update.png" alt="Upgrade">
    </div>
    <div id="star-container">
        <img id="star-btn" src="assets/star.png" alt="Rebirth" title="Rebirth">
    </div>
    <div id="brick-container" class="hidden">
        <img id="brick-img" src="assets/brick.png" alt="Brick" title="Brick" style="width:32px;height:32px;vertical-align:middle;">
        <span id="brick-count">Brick: 0</span>
    </div>
</div>


<div id="upgrade-window" class="hidden">
    <div class="upgrade-grid">
        <div class="upgrade-item" data-index="0">
            <div class="upgrade-title">+1 Scrap/click</div>
            <div class="upgrade-level">Level: <span id="upgrade-level-0">0</span></div>
            <div class="upgrade-cost" id="upgrade-cost-0">5 Scrap</div>
        </div>
        <div class="upgrade-item hidden" data-index="1">
            <div class="upgrade-title">Autoclicker (1 Scrap/s)</div>
            <div class="upgrade-level"><span id="upgrade-level-1">0</span>/1</div>
            <div class="upgrade-cost" id="upgrade-cost-1">50 Scrap</div>
        </div>
        <div class="upgrade-item hidden" data-index="2">
            <div class="upgrade-title">-0.10 Cooldown</div>
            <div class="upgrade-level"><span id="upgrade-level-2">0</span>/30</div>
            <div class="upgrade-cost" id="upgrade-cost-2">30 Scrap</div>
        </div>
        <div class="upgrade-item hidden" data-index="3">
            <div class="upgrade-title">Funny Joke</div>
            <div class="upgrade-level"><span id="upgrade-level-3">0</span>/10</div>
            <div class="upgrade-cost" id="upgrade-cost-3">—</div>
        </div>
        <div class="upgrade-item hidden" data-index="4">
            <div class="upgrade-title">Mass Scrap</div>
            <div class="upgrade-level"><span id="upgrade-level-4">0</span>/10</div>
            <div class="upgrade-cost" id="upgrade-cost-4">—</div>
        </div>
    </div>
    <div id="close-upgrades">✕</div>
</div>

<div id="scrapyard-window" class="hidden">
    <div class="scrapyard-content">

        <div class="scrapyard-left">
            <h3>ScrapYard</h3>
            <div class="scrapyard-description">
                ScrapYard 100 Scrap/min<br>
                <small style="visibility: hidden;">Spacing element</small>
            </div>
            <img id="scrapyard-image" src="assets/scrapyard.png" alt="ScrapYard">
            <div id="scrapyard-cost">2000 Scrap</div>
            <button id="buy-scrapyard">Buy</button>
        </div>
        

        <div id="brickyard-separator" class="hidden"></div>
        

        <div id="brickyard-section" class="hidden">
            <h3>BrickYard</h3>
            <div class="brickyard-description">
                +1 Brick<br>
                <small>Cost: 10 Scrap + 5 Master Tokens</small>
            </div>
            <img id="brickyard-image" src="assets/brickyard.png" alt="BrickYard">
            <div id="brickyard-cost">10 Scrap + 5 Master Tokens</div>
            <button id="buy-brick">Buy 1 Brick</button>
        </div>


        <div id="tilesyard-separator" class="hidden"></div>


        <div id="tilesyard-section" class="hidden">
            <h3>TiresYard</h3>
            <div class="tilesyard-description">
                Collect more tires by picking 1<br>
                <small>(+1 Tires per 1 level, 1 level = 10 Tiers)</small>
            </div>
            <img id="tilesyard-image" src="assets/tilesyard.png" alt="TilesYard">
            <div id="tilesyard-status">Unlocked</div>
            <div id="tiles-upgrade-level">Tier: 0/10</div>
            <div id="tiles-level-label">Level: 0</div>
            <button id="tiles-upgrade-btn">Upgrade</button>
        </div>
    </div>
    <div id="close-scrapyard">✕</div>
</div>


<div id="rebirth-window" class="hidden">
    <div class="rebirth-content">
    <h3>Rebirth</h3>
        <div id="rebirth-count" style="font-size:16px;color:#f1c40f;margin:6px 0 10px;">Rebirth: 0</div>
        <div class="rebirth-description">
            Rebirth resets your progress and grants a rebirth point.<br>
            Required: <span id="rebirth-cost-placeholder">...</span> Scrap<br><br>
            <strong>WARNING:</strong> This will reset all your upgrades and scrap!
        </div>
        <button id="confirm-rebirth">Rebirth</button>
    </div>
    <div id="close-rebirth">✕</div>
</div>


<div id="chat-window" class="hidden">
        <div class="chat-content">
        <div class="chat-header">
            <h3>Global Chat</h3>
            <div class="chat-actions">
                <div id="chat-status">Disconnected</div>
                <button id="chat-minimize" title="Minimize">–</button>
            </div>
        </div>
        <div id="chat-messages"></div>
        <div class="chat-input-row">
            <input id="chat-input" type="text" placeholder="Type a message and press Enter..." maxlength="200">
            <button id="chat-send" disabled>Send</button>
        </div>
    </div>
    <div id="close-chat">✕</div>
    
</div>


<div id="funnyjoke-window" class="hidden">
    <div class="funnyjoke-content">
        <h3>Special Note</h3>
        <div id="funnyjoke-message" class="funnyjoke-message"></div>
        <button id="funnyjoke-close">Continue</button>
    </div>
    <div id="close-funnyjoke">✕</div>
    
</div>

<!-- Item Shop window at root level -->
<div id="itemshop-window" class="hidden">
    <div class="itemshop-content">
        <div class="itemshop-header">
            <h3>Item Shop</h3>
            <div class="itemshop-timer">Restock in: <span id="itemshop-timer">--:--:--</span></div>
        </div>
        <div id="itemshop-grid" class="itemshop-grid"></div>
        <div id="close-itemshop" class="close-btn">✕</div>
    </div>
    
</div>
<script src="items.js"></script>
<script src="rary.js"></script>


<!-- Inventory window -->
<div id="inventory-window" class="hidden">
    <div class="inventory-content">
        <div class="inventory-header">
            <h3>Inventory</h3>
            <div class="inventory-capacity">Slots: <span id="inventory-count">0</span>/6</div>
        </div>
        <div id="inventory-grid" class="inventory-grid"></div>
        <div id="reload-inventory" class="close-btn" title="Odśwież z serwera">↻</div>
        <div id="close-inventory" class="close-btn">✕</div>
    </div>
    
    
</div>

<!-- Item Hint window -->
<div id="itemhint-window" class="hidden">
    <div class="itemhint-content">
        <h3 id="itemhint-title">Item</h3>
        <div id="itemhint-text" class="itemhint-text"></div>
        <div id="close-itemhint" class="close-btn">✕</div>
    </div>
</div>

<div id="greenupgrade-window" class="hidden">
    <div class="greenupgrade-content">
    <h3>Barrel Selector</h3>
        <div class="greenupgrade-description">
            Select a barrel to increase your Scrap production.<br>
            Each barrel has a different Scrap/click bonus.<br>
        </div>
        <div class="greenupgrade-grid">
    <div class="greenupgrade-item">
        <img src="assets/scrap.png" alt="Scrap">
        <button class="greenupgrade-button">Equip</button>
        <div class="greenupgrade-text">+0 Scrap/Click</div>
    </div>
    <div class="greenupgrade-item">
        <img src="assets/barrel1.png" alt="Barrel 1">
        <button class="greenupgrade-button">Equip</button>
        <div class="greenupgrade-text">+1 Scrap/Click</div>
    </div>
    <div class="greenupgrade-item">
        <img src="assets/barrel2.png" alt="Barrel 2">
        <button class="greenupgrade-button">Equip</button>
        <div class="greenupgrade-text">+2 Scrap/Click</div>
    </div>
    <div class="greenupgrade-item">
        <img src="assets/barrel3.png" alt="Barrel 3">
        <button class="greenupgrade-button">Equip</button>
        <div class="greenupgrade-text">+3 Scrap/Click</div>
    </div>
    <div class="greenupgrade-item">
        <img src="assets/barrel4.png" alt="Barrel 4">
        <button class="greenupgrade-button">Equip</button>
        <div class="greenupgrade-text">+4 Scrap/Click</div>
    </div>
    <div class="greenupgrade-item">
        <img src="assets/barrel5.png" alt="Barrel 5">
        <button class="greenupgrade-button">Equip</button>
        <div class="greenupgrade-text">+5 Scrap/Click</div>
    </div>
    <div class="greenupgrade-item">
        <img src="assets/Barrel6.png" alt="Barrel 6">
        <button class="greenupgrade-button">Equip</button>
        <div class="greenupgrade-text">+6 Scrap/Click</div>
    </div>
    <div class="greenupgrade-item">
        <img src="assets/Barrel7.png" alt="Barrel 7">
        <button class="greenupgrade-button">Equip</button>
        <div class="greenupgrade-text">+7 Scrap/Click</div>
    </div>
    <div class="greenupgrade-item">
        <img src="assets/Barrel8.png" alt="Barrel 8">
        <button class="greenupgrade-button">Equip</button>
        <div class="greenupgrade-text">+8 Scrap/Click</div>
    </div>
</div>
        <div id="close-greenupgrade">✕</div>
    </div>
</div>


<div id="mysterybook-window" class="hidden">
    <div class="mysterybook-content">
        <h3>Mystery Book</h3>
        <div class="mysterybook-description">
            Upgrade barrels using Master Tokens.
        </div>
        <div class="mysterybook-grid">
            <div class="mysterybook-item">
                <img src="assets/scrap.png" alt="Scrap">
                <button class="mysterybook-button" data-cost="1">Upgrade</button>
                <div class="mysterybook-level">Level: 0/5</div>
                <div class="mysterybook-cost">Cost: 1 Master Token</div>
            </div>
            <div class="mysterybook-item">
                <img src="assets/barrel1.png" alt="Barrel 1">
                <button class="mysterybook-button" data-cost="2">Upgrade</button>
                <div class="mysterybook-level">Level: 0/5</div>
                <div class="mysterybook-cost">Cost: 2 Master Token</div>
            </div>
            <div class="mysterybook-item">
                <img src="assets/barrel2.png" alt="Barrel 2">
                <button class="mysterybook-button" data-cost="4">Upgrade</button>
                <div class="mysterybook-level">Level: 0/5</div>
                <div class="mysterybook-cost">Cost: 4 Master Token</div>
            </div>
            <div class="mysterybook-item">
                <img src="assets/barrel3.png" alt="Barrel 3">
                <button class="mysterybook-button" data-cost="8">Upgrade</button>
                <div class="mysterybook-level">Level: 0/5</div>
                <div class="mysterybook-cost">Cost: 8 Master Token</div>
            </div>
            <div class="mysterybook-item">
                <img src="assets/barrel4.png" alt="Barrel 4">
                <button class="mysterybook-button" data-cost="16">Upgrade</button>
                <div class="mysterybook-level">Level: 0/5</div>
                <div class="mysterybook-cost">Cost: 16 Master Token</div>
            </div>
            <div class="mysterybook-item">
                <img src="assets/barrel5.png" alt="Barrel 5">
                <button class="mysterybook-button" data-cost="32">Upgrade</button>
                <div class="mysterybook-level">Level: 0/5</div>
                <div class="mysterybook-cost">Cost: 32 Master Token</div>
            </div>
            <div class="mysterybook-item">
                <img src="assets/Barrel6.png" alt="Barrel 6">
                <button class="mysterybook-button" data-cost="64">Upgrade</button>
                <div class="mysterybook-level">Level: 0/5</div>
                <div class="mysterybook-cost">Cost: 64 Master Token</div>
            </div>
            <div class="mysterybook-item">
                <img src="assets/Barrel7.png" alt="Barrel 7">
                <button class="mysterybook-button" data-cost="128">Upgrade</button>
                <div class="mysterybook-level">Level: 0/5</div>
                <div class="mysterybook-cost">Cost: 128 Master Token</div>
            </div>
            <div class="mysterybook-item">
                <img src="assets/Barrel8.png" alt="Barrel 8">
                <button class="mysterybook-button" data-cost="256">Upgrade</button>
                <div class="mysterybook-level">Level: 0/5</div>
                <div class="mysterybook-cost">Cost: 256 Master Token</div>
            </div>
        </div>
        <div id="master-token-display">
            <img src="assets/master.png" alt="Master Tokens">
            <div id="master-token-count">Master Tokens: 0</div>
        </div>
        <div id="close-mysterybook">✕</div>
    </div>
</div>


<div id="blueupgrade-window" class="hidden">
    <div class="greenupgrade-content">
    <h3>Better Upgrades</h3>
        <div class="greenupgrade-description">
            Spend Tires on permanent upgrades.
        </div>
    <div id="blueupgrade-grid">

            <div class="blueupgrade-item" id="blue-better-upgrades" style="cursor:pointer;">
                <div class="blueupgrade-title" style="font-size:16px;color:#4aa3ff;font-weight:bold;">More Scrap</div>
                <div class="blueupgrade-level" id="blue-better-level" style="font-size:14px;">Level: 0/16</div>
                <div class="blueupgrade-effect" id="blue-better-effect" style="font-size:13px;color:#ccc;">Current: x1.00 ( +0.25x / lvl )</div>
                <div class="blueupgrade-cost" id="blue-better-cost" style="font-size:13px;color:#9b59b6;">Cost: 100 Tires</div>
            </div>

                <div class="blueupgrade-item" id="blue-tires-upgrade" style="cursor:pointer;">
                    <div class="blueupgrade-title" style="font-size:16px;color:#4aa3ff;font-weight:bold;">The Tires</div>
                    <div class="blueupgrade-level" id="blue-tires-level" style="font-size:14px;">Level: 0/30</div>
                    <div class="blueupgrade-effect" id="blue-tires-effect" style="font-size:13px;color:#ccc;">Current: x1 → x100 ( +100 / lvl )</div>
                    <div class="blueupgrade-cost" id="blue-tires-cost" style="font-size:13px;color:#9b59b6;">Cost: 35000 Tires</div>
                </div>

                <div class="blueupgrade-item" id="blue-earnings-upgrade" style="cursor:pointer;">
                    <div class="blueupgrade-title" style="font-size:16px;color:#4aa3ff;font-weight:bold;">The Earnings</div>
                    <div class="blueupgrade-level" id="blue-earnings-level" style="font-size:14px;">Level: 0/10</div>
                    <div class="blueupgrade-effect" id="blue-earnings-effect" style="font-size:13px;color:#ccc;">Current: +0 Scrap/click (+1000 / lvl)</div>
                    <div class="blueupgrade-cost" id="blue-earnings-cost" style="font-size:13px;color:#9b59b6;">Cost: 3000 Tires</div>
                </div>
        </div>
        <div id="close-blueupgrade">✕</div>
    </div>
    
</div>

<div id="tree-window" class="hidden">
    <div class="tree-content">
    <h3>Skill Tree</h3>
        <div class="tree-description">
            Unlock powerful upgrades with Master Tokens!
        </div>
        <div class="tree-grid" id="tree-grid">

            <div class="tree-slot" id="slot-0"></div>
            <div class="tree-slot" id="slot-1"></div>
            <div class="tree-slot" id="slot-2"></div>
            <div class="tree-slot" id="slot-3"></div>
            <div class="tree-slot" id="slot-4"></div>
            <div class="tree-slot" id="slot-5"></div>
            <div class="tree-slot" id="slot-6"></div>
            <div class="tree-slot" id="slot-7"></div>
            <div class="tree-slot" id="slot-8"></div>

            <!-- Connection lines (SVG overlay) -->
            <svg class="tree-connections" viewBox="0 0 420 880" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">
                <!-- Better Scrapyard to Tires (left) -->
                <line x1="210" y1="100" x2="70" y2="170" stroke="#333" stroke-width="4"/>
                <!-- Better Scrapyard to Best Scrapyard (right) -->
                <line x1="210" y1="100" x2="350" y2="170" stroke="#333" stroke-width="4"/>
                <!-- Tires to Blue Upgrades (center) -->
                <line x1="70" y1="210" x2="210" y2="310" stroke="#333" stroke-width="4"/>
                <!-- Best Scrapyard to Blue Upgrades (center) -->
                <line x1="350" y1="210" x2="210" y2="310" stroke="#333" stroke-width="4"/>
                <!-- Tires to TiresYard (right dashed) -->
                <line x1="70" y1="210" x2="350" y2="310" stroke="#333" stroke-width="4" stroke-dasharray="12 10"/>
                <!-- Blue Upgrades to Storm (vertical) -->
                <line x1="210" y1="330" x2="210" y2="450" stroke="#333" stroke-width="4"/>
                <!-- Storm split to Brick Storm (left) -->
                <line x1="210" y1="470" x2="70" y2="600" stroke="#333" stroke-width="4"/>
                <!-- Storm split to Master Tokens Storm (right) -->
                <line x1="210" y1="470" x2="350" y2="600" stroke="#333" stroke-width="4"/>
                <!-- Brick Storm to Star Power -->
                <line x1="70" y1="610" x2="210" y2="730" stroke="#333" stroke-width="4"/>
                <!-- Master Tokens Storm to Star Power -->
                <line x1="350" y1="610" x2="210" y2="730" stroke="#333" stroke-width="4"/>
            </svg>
        </div>
        <div id="close-tree">✕</div>
    </div>
</div>


<div id="tree-info-window" class="hidden">
    <div class="tree-info-content improved-ui">
    <h3 id="tree-info-title">Better Scrapyard</h3>

            
        <div class="tree-info-description" id="tree-info-description">
            Upgrade your Scrapyard from 100 Scrap per minute to 100 Scrap per second!<br>
            <span style="font-size: 1.1em; color: #e67e22; font-weight: bold;">Cost: 25 Brick</span>
        </div>
        <button class="tree-info-button" id="tree-info-buy-btn" style="margin: 20px 0; padding: 12px 32px; font-size: 1.1em; background: linear-gradient(90deg,#e67e22,#f1c40f); color: #fff; border:none; border-radius:8px; box-shadow:0 2px 8px #0002; cursor:pointer;">Upgrade for 25 Brick</button>
        <div id="close-tree-info" style="position:absolute;top:12px;right:18px;font-size:1.5em;cursor:pointer;">✕</div>
    </div>
</div>

<!-- Leaderboard window at root level (moved out of hidden parents) -->
<div id="leaderboard-window" class="hidden">
    <div class="leaderboard-content">
        <div class="leaderboard-header">
            <h3>Leaderboard</h3>
            <div class="leaderboard-tabs">
                <button class="lb-tab active" data-tab="rebirths">Rebirths</button>
                <button class="lb-tab" data-tab="maxscrap">Max Scrap</button>
                <button class="lb-tab" data-tab="maxtires">Tires (peak)</button>
            </div>
        </div>
        <div class="leaderboard-body">
            <div id="leaderboard-list"></div>
            <div class="leaderboard-note">Set your chat nickname to appear.</div>
        </div>
        <div id="close-leaderboard">✕</div>
    </div>
</div>

    <div id="settings-window" class="hidden">
        <div class="settings-content">
            <h3>Settings</h3>
            <div id="settings-stats" class="settings-stats">
                <div class="stat"><span class="label">Now:</span> <span id="stat-now">-</span></div>
                <div class="stat"><span class="label">Session start:</span> <span id="stat-session-start">-</span></div>
                <div class="stat"><span class="label">Session time:</span> <span id="stat-session-time">-</span></div>
                <div class="stat"><span class="label">Total time:</span> <span id="stat-total-time">-</span></div>
                <div class="stat"><span class="label">First seen:</span> <span id="stat-first-seen">-</span></div>
                <div class="stat"><span class="label">Last seen:</span> <span id="stat-last-seen">-</span></div>
                <div class="stat"><span class="label">Sessions:</span> <span id="stat-sessions">-</span></div>
                <div class="stat"><span class="label">Clicks (session/total):</span> <span id="stat-clicks">0 / 0</span></div>
                <div class="stat"><span class="label">CPS (clicks per second):</span> <span id="stat-cps">0</span></div>
                <div class="stat"><span class="label">Scrap earned:</span> <span id="stat-scrap-earned">0</span></div>
                <div class="stat"><span class="label">Scrap spent:</span> <span id="stat-scrap-spent">0</span></div>
                <div class="stat"><span class="label">Session scrap:</span> <span id="stat-scrap-session">0</span></div>
                <div class="stat"><span class="label">SPS (scrap per second):</span> <span id="stat-sps">0</span></div>
                <div class="stat"><span class="label">Peak scrap:</span> <span id="stat-peak-scrap">0</span></div>
                <div class="stat"><span class="label">Best click yield:</span> <span id="stat-best-click">0</span></div>
                <div class="stat"><span class="label">Rebirths:</span> <span id="stat-rebirths">0</span></div>
                <div class="stat"><span class="label">Last rebirth:</span> <span id="stat-last-rebirth">-</span></div>
                <div class="stat"><span class="label">Bricks bought:</span> <span id="stat-bricks-bought">0</span></div>
                <div class="stat"><span class="label">Tires spawned/collected:</span> <span id="stat-tires">0 / 0</span></div>
                <div class="stat"><span class="label">Tiles earned:</span> <span id="stat-tiles-earned">0</span></div>
                <div class="stat"><span class="label">Tiles spent:</span> <span id="stat-tiles-spent">0</span></div>
                <div class="stat"><span class="label">Autoclicks:</span> <span id="stat-autoclicks">0</span></div>
                <div class="stat"><span class="label">Autoclicks (session):</span> <span id="stat-autoclicks-session">0</span></div>
                <div class="stat"><span class="label">Scrapyard ticks:</span> <span id="stat-scrapyard-ticks">0</span></div>
                <div class="stat"><span class="label">Scrapyard runtime:</span> <span id="stat-scrapyard-uptime">0</span></div>
                <div class="stat"><span class="label">Storms:</span> <span id="stat-storms">0</span></div>
                <div class="stat"><span class="label">Upgrades bought:</span> <span id="stat-upgrades-bought">0</span></div>
                <div class="stat"><span class="label">Blue upgrades (b/e/t):</span> <span id="stat-blue-bought">0</span></div>
                <div class="stat"><span class="label">Master Tokens spent:</span> <span id="stat-tokens-spent">0</span></div>
            </div>
            <div class="settings-actions">
                <button id="export-save-btn">Export Save</button>
                <button id="reset-save-btn">Reset Save</button>
                <button id="import-save-btn">Import Save</button>
                <input type="file" id="import-save-input" accept="application/json" class="visually-hidden" />
            </div>
            <img id="settings-palette" src="assets/pallet.png" alt="Palette">
            <div id="settings-theme-label">Theme: <span id="settings-theme-name">Dark</span></div>
            <div id="close-settings">✕</div>
        </div>
    </div>
    

    <div id="storm-timer" style="position:fixed;left:12px;bottom:10px;font-family:monospace;font-size:18px;background:rgba(0,0,0,0.45);color:#fff;padding:4px 10px;border-radius:6px;display:none;z-index:5000;">04:00</div>


            <div id="chat-name-window" class="hidden">
                <div class="chat-name-content">
                    <h3>Set Nickname</h3>
                    <p style="margin:6px 0 12px;color:var(--muted);font-size:13px;">Enter Username</p>
                    <input id="chat-name-input" type="text" maxlength="20" placeholder="e.g. ScrapMaster69" />
                    <div class="chat-name-actions">
                        <button id="chat-name-save" class="primary">Save</button>
                    </div>
                    <div id="close-chat-name">✕</div>
                </div>
            </div>

    <script>
        window.SM_WS_URL = (location.protocol === 'https:'
            ? `wss://${location.host}`
            : `ws://${location.hostname}:3000`);

        (function ensureChatNameStyles(){
            try {
                var el = document.getElementById('chat-name-window');
                if (el) {
                    var computed = window.getComputedStyle(el);
                    var hasDisplayRule = computed && (computed.display === 'none' || computed.display === 'flex');
                    if (hasDisplayRule) return;
                }
            } catch(_) {}
            var css = `#chat-name-window{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.65);backdrop-filter:blur(2px);z-index:6000}`+
                      `#chat-name-window:not(.hidden){display:flex}`+
                      `.chat-name-content{width:min(440px,92vw);background:#111;border:1px solid #2f3640;border-radius:12px;padding:16px;box-shadow:0 16px 36px rgba(0,0,0,.55);position:relative;color:#f1f5f9;display:grid;grid-template-columns:1fr auto;grid-auto-rows:auto;gap:10px}`+
                      `.chat-name-content h3{margin:0 0 8px;color:#e8f1ff;grid-column:1/-1}`+
                      `.chat-name-content p{margin:6px 0 0;color:#9fb1bf;font-size:13px;grid-column:1/-1}`+
                      `.chat-name-content input{grid-column:1;width:100%;padding:10px 12px;border:1px solid #3c5c72;border-radius:10px;background:#0e141a;color:#e6f1ff;margin:0;outline:none;align-self:center}`+
                      `.chat-name-content input::placeholder{color:#7f97a8;opacity:1}`+
                      `.chat-name-content input:focus{border-color:#4aa3ff;box-shadow:0 0 0 3px rgba(74,163,255,.22)}`+
                      `.chat-name-actions{grid-column:2;align-self:center;margin:0}`+
                      `#chat-name-save{background:#2370ff;border:1px solid #215fe0;color:#fff;padding:10px 14px;border-radius:10px;cursor:pointer;box-shadow:0 2px 0 rgba(0,0,0,.25)}`+
                      `#chat-name-save:hover{filter:brightness(1.08)}`+
                      `#close-chat-name{position:absolute;top:10px;right:12px;cursor:pointer;font-size:18px;color:#aaa}`+
                      `#close-chat-name:hover{color:#fff}`;
            var style = document.createElement('style');
            style.id = 'inline-chat-name-styles';
            style.textContent = css;
            document.head.appendChild(style);
        })();
    </script>
    <script src="script.js?v=1.0.4"></script>
    <script src="savescript.js?v=1.4.2"></script>
    <script src="admincommands.js"></script>
</body>
</html>
